{"ast":null,"code":"import { HttpHeaders } from \"@angular/common/http\";\nimport { catchError } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class DataService {\n  constructor(http) {\n    this.http = http;\n    this.baseUrl = 'http://localhost:3000';\n    this.header = new HttpHeaders();\n    this.header = this.header.append(\"Accept\", \"application/json\");\n    this.header = this.header.append(\"Content-Type\", \"application/json\");\n    if (localStorage.getItem('token')) {\n      this.header = this.header.set('Authorization', `Bearer ${localStorage.getItem('token')}`);\n    }\n  }\n  get(path) {\n    let urlApi = this.baseUrl + path;\n    return new Promise((win, lose) => {\n      this.http.get(urlApi, {}).pipe(catchError(err => {\n        lose(err);\n        return err;\n      })).subscribe(res => {\n        win(res);\n      });\n    });\n  }\n  post(path, body) {\n    let urlApi = this.baseUrl + path;\n    return new Promise((resolve, reject) => {\n      // RESOLVE: thanh cong; REJECT: that bai\n      this.http.post(urlApi, body, {\n        headers: this.header\n      }).pipe(catchError(err => {\n        reject(err);\n        return err;\n      })).subscribe(res => {\n        resolve(res);\n      });\n    });\n  }\n  patch(path, body) {\n    let urlApi = this.baseUrl + path;\n    return new Promise((resolve, reject) => {\n      this.http.patch(urlApi, body, {\n        headers: this.header\n      }).subscribe(res => {\n        resolve(res);\n      }, err => {\n        reject(err);\n      });\n    });\n  }\n  login(phonenumber, password) {\n    const body = {\n      phonenumber: phonenumber,\n      password: password\n    };\n    return new Promise((resolve, reject) => {\n      this.http.post(`${this.baseUrl}/login`, body).subscribe(res => {\n        // Thêm accept_token vào header\n        this.header = this.header.set('Authorization', `Bearer ${res.access_token}`);\n        localStorage.setItem('token', res.access_token);\n        resolve(res);\n      }, err => reject(err));\n    });\n  }\n  register(username, password, email) {\n    const body = {\n      username: username,\n      password: password,\n      email: email\n    };\n    return this.post('/register', body);\n  }\n}\nDataService.ɵfac = function DataService_Factory(t) {\n  return new (t || DataService)(i0.ɵɵinject(i1.HttpClient));\n};\nDataService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: DataService,\n  factory: DataService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["HttpHeaders","catchError","DataService","constructor","http","header","append","localStorage","getItem","set","get","path","urlApi","baseUrl","Promise","win","lose","pipe","err","subscribe","res","post","body","resolve","reject","headers","patch","login","phonenumber","password","access_token","setItem","register","username","email","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\ttri0\\OneDrive\\Documents\\GitHub\\ANGULAR\\shop\\src\\app\\service\\data.service.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\nimport { HttpClient, HttpHeaders } from \"@angular/common/http\";\nimport { catchError } from \"rxjs\";\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DataService {\n\tprivate baseUrl: string = 'http://localhost:3000';\n\theader: HttpHeaders = new HttpHeaders();\n\tconstructor(private http: HttpClient) {\n\t\tthis.header = this.header.append(\"Accept\", \"application/json\");\n\t\tthis.header = this.header.append(\"Content-Type\", \"application/json\");\n\t\tif(localStorage.getItem('token')){\n\t\t\tthis.header = this.header.set('Authorization', `Bearer ${localStorage.getItem('token')}`);\n\t\t}\n\t}\n\tget(path: string) {\n\t\tlet urlApi = this.baseUrl + path;\n\t\treturn new Promise((win, lose) => {\n\t\t\tthis.http\n\t\t\t\t.get(urlApi, {})\n\t\t\t\t.pipe(\n\t\t\t\t\tcatchError((err) => {\n\t\t\t\t\t\tlose(err);\n\t\t\t\t\t\treturn err;\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.subscribe((res) => {\n\t\t\t\t\twin(res);\n\t\t\t\t});\n\t\t});\n\t}\n\tpost(path: string, body: any) {\n\t\tlet urlApi = this.baseUrl + path;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// RESOLVE: thanh cong; REJECT: that bai\n\t\t\tthis.http\n\t\t\t\t.post(urlApi, body, { headers: this.header })\n\t\t\t\t.pipe(\n\t\t\t\t\tcatchError((err) => {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t\treturn err;\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.subscribe((res) => {\n\t\t\t\t\tresolve(res);\n\t\t\t\t});\n\t\t});\n\t}\n\tpatch(path: string, body: any) {\n\t\tlet urlApi = this.baseUrl + path;\n\t\treturn new Promise((resolve, reject) => {\n\t\t  this.http\n\t\t\t.patch(urlApi, body, { headers: this.header })\n\t\t\t.subscribe(\n\t\t\t  (res) => {\n\t\t\t\tresolve(res);\n\t\t\t  },\n\t\t\t  (err) => {\n\t\t\t\treject(err);\n\t\t\t  }\n\t\t\t);\n\t\t});\n\t  }\n\tlogin(phonenumber: string, password: string) {\n\t\tconst body = {\n\t\t\tphonenumber: phonenumber,\n\t\t\tpassword: password\n\t\t};\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.http.post(`${this.baseUrl}/login`, body).subscribe((res: any) => {\n\t\t\t\t// Thêm accept_token vào header\n\t\t\t\tthis.header = this.header.set('Authorization', `Bearer ${res. access_token}`);\n\t\t\t\tlocalStorage.setItem('token', res. access_token);\n\t\t\t\tresolve(res);\n\t\t\t}, err => reject(err));\n\t\t});\n\t}\n\n\tregister(username: string, password: string, email: string) {\n\t\tconst body = {\n\t\t\tusername: username,\n\t\t\tpassword: password,\n\t\t\temail: email\n\t\t};\n\t\treturn this.post('/register', body);\n\t}\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}